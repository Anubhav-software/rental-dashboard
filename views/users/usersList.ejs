<div class="card h-100 p-0 radius-12">
    <div class="card-header border-bottom bg-base py-16 px-24 d-flex align-items-center flex-wrap gap-3 justify-content-between">
        <h6 class="text-md fw-medium text-secondary-light mb-0 d-flex align-items-center gap-2">
            <iconify-icon icon="flowbite:users-group-outline" class="text-primary-600"></iconify-icon>
            Staff Management
        </h6>
        <button type="button" class="btn btn-primary text-sm btn-sm px-12 py-12 radius-8 d-flex align-items-center gap-2" data-bs-toggle="modal" data-bs-target="#addStaffModal">
            <iconify-icon icon="ic:baseline-plus" class="icon text-xl line-height-1"></iconify-icon>
            Add New Staff
        </button>
    </div>
    <div class="card-body p-24">
        <div id="staff-api-error" class="alert alert-danger radius-12 mb-24 d-none"></div>
        <div id="staff-api-success" class="alert alert-success radius-12 mb-24 d-none"></div>
        
        <!-- Loading State -->
        <div id="staff-loading" class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-3 text-secondary-light">Loading staff members...</p>
        </div>

        <!-- Empty State -->
        <div id="staff-empty" class="text-center py-5 d-none">
            <iconify-icon icon="flowbite:users-group-outline" class="text-secondary-light" style="font-size: 64px;"></iconify-icon>
            <h5 class="mt-3 text-secondary-light">No Staff Members Yet</h5>
            <p class="text-secondary-light">Click "Add New Staff" to create your first staff member.</p>
        </div>

        <!-- Table -->
        <div id="staff-table-container" class="d-none">
            <div class="table-responsive scroll-sm">
                <table class="table bordered-table sm-table mb-0">
                    <thead>
                        <tr>
                            <th scope="col">S.No</th>
                            <th scope="col">Join Date</th>
                            <th scope="col">Name</th>
                            <th scope="col">Email</th>
                            <th scope="col">Role</th>
                            <th scope="col" class="text-center">Status</th>
                            <th scope="col">Company</th>
                            <th scope="col" class="text-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="staff-table-body">
                        <!-- Staff rows will be inserted here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteStaffModal" tabindex="-1" aria-labelledby="deleteStaffModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content radius-16 bg-base shadow-lg border-0">
            <!-- Modal Header -->
            <div class="modal-header border-0 py-20 px-32" style="background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);">
                <div class="d-flex align-items-center gap-3">
                    <div class="w-48-px h-48-px rounded-circle bg-white bg-opacity-25 d-flex align-items-center justify-content-center">
                        <iconify-icon icon="mdi:alert-circle" class="text-white" style="font-size: 24px;"></iconify-icon>
                    </div>
                    <div>
                        <h5 class="modal-title text-white fw-bold mb-0" id="deleteStaffModalLabel">Delete Staff Member</h5>
                        <p class="text-white text-opacity-75 mb-0" style="font-size: 13px;">This action cannot be undone</p>
                    </div>
                </div>
                <button type="button" class="btn-close btn-close-white opacity-75" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            
            <!-- Modal Body -->
            <div class="modal-body p-32">
                <input type="hidden" id="delete-staff-id">
                
                <div id="delete-modal-error" class="alert alert-danger radius-12 mb-24 d-none"></div>
                
                <div class="text-center mb-24">
                    <div class="w-80-px h-80-px rounded-circle mx-auto mb-16 d-flex align-items-center justify-content-center" style="background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);">
                        <iconify-icon icon="mdi:delete-alert" style="font-size: 40px; color: #dc2626;"></iconify-icon>
                    </div>
                    <h5 class="mb-8 text-dark">Are you sure?</h5>
                    <p class="text-secondary-light mb-16">You are about to delete:</p>
                    <p class="fw-semibold text-lg mb-0" style="color: #dc2626;" id="delete-staff-name-display"></p>
                </div>

                <div class="card border-0 radius-12 mb-24" style="background: #fef2f2; border-left: 4px solid #dc2626 !important;">
                    <div class="card-body p-16">
                        <p class="text-sm mb-2 fw-medium" style="color: #991b1b;">⚠️ Warning:</p>
                        <ul class="text-sm mb-0 ps-3" style="color: #b91c1c;">
                            <li>This staff member will be permanently deleted</li>
                            <li>They will no longer be able to login</li>
                            <li>This action cannot be reversed</li>
                        </ul>
                    </div>
                </div>

                <div class="d-flex align-items-center justify-content-end gap-3">
                    <button type="button" class="btn btn-outline-secondary text-sm px-24 py-12 radius-8 d-flex align-items-center gap-2" data-bs-dismiss="modal">
                        <iconify-icon icon="mdi:close" class="icon"></iconify-icon>
                        Cancel
                    </button>
                    <button type="button" id="confirm-delete-staff" class="btn text-sm px-24 py-12 radius-8 d-flex align-items-center gap-2" style="background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%); color: white; border: none;">
                        <iconify-icon icon="mdi:delete-forever" class="icon text-lg"></iconify-icon>
                        Yes, Delete
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Edit Staff Modal -->
<div class="modal fade" id="editStaffModal" tabindex="-1" aria-labelledby="editStaffModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content radius-16 bg-base shadow-lg border-0">
            <!-- Modal Header -->
            <div class="modal-header border-0 py-20 px-32" style="background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);">
                <div class="d-flex align-items-center gap-3">
                    <div class="w-48-px h-48-px rounded-circle bg-white bg-opacity-25 d-flex align-items-center justify-content-center">
                        <iconify-icon icon="mdi:account-edit" class="text-white" style="font-size: 24px;"></iconify-icon>
                    </div>
                    <div>
                        <h5 class="modal-title text-white fw-bold mb-0" id="editStaffModalLabel">Edit Staff Member</h5>
                        <p class="text-white text-opacity-75 mb-0" style="font-size: 13px;">Update staff information and status</p>
                    </div>
                </div>
                <button type="button" class="btn-close btn-close-white opacity-75" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            
            <!-- Modal Body -->
            <div class="modal-body p-32">
                <div id="edit-modal-error" class="alert alert-danger radius-12 mb-24 d-none d-flex align-items-center gap-2">
                    <iconify-icon icon="mdi:alert-circle-outline" class="text-xl"></iconify-icon>
                    <span id="edit-modal-error-text"></span>
                </div>
                <div id="edit-modal-success" class="alert alert-success radius-12 mb-24 d-none d-flex align-items-center gap-2">
                    <iconify-icon icon="mdi:check-circle-outline" class="text-xl"></iconify-icon>
                    <span id="edit-modal-success-text"></span>
                </div>

                <form id="edit-staff-form">
                    <input type="hidden" id="edit-staff-id" name="id">
                    <div class="row g-3">
                        <div class="col-12">
                            <label class="form-label fw-semibold text-primary-light text-sm mb-8 d-flex align-items-center gap-2">
                                <iconify-icon icon="mdi:account-outline" style="color: #2563eb;"></iconify-icon>
                                Full Name <span class="text-danger">*</span>
                            </label>
                            <div class="icon-field">
                                <span class="icon top-50 translate-middle-y">
                                    <iconify-icon icon="mdi:account" class="text-secondary-light"></iconify-icon>
                                </span>
                                <input type="text" name="name" id="edit-staff-name" class="form-control h-56-px bg-neutral-50 radius-12 ps-48" required>
                            </div>
                        </div>

                        <div class="col-12">
                            <label class="form-label fw-semibold text-primary-light text-sm mb-8 d-flex align-items-center gap-2">
                                <iconify-icon icon="mdi:email-outline" style="color: #2563eb;"></iconify-icon>
                                Email Address <span class="text-danger">*</span>
                            </label>
                            <div class="icon-field">
                                <span class="icon top-50 translate-middle-y">
                                    <iconify-icon icon="mage:email" class="text-secondary-light"></iconify-icon>
                                </span>
                                <input type="email" name="email" id="edit-staff-email" class="form-control h-56-px bg-neutral-50 radius-12 ps-48" required>
                            </div>
                        </div>

                        <div class="col-12">
                            <label class="form-label fw-semibold text-primary-light text-sm mb-8 d-flex align-items-center gap-2">
                                <iconify-icon icon="mdi:toggle-switch" style="color: #2563eb;"></iconify-icon>
                                Status <span class="text-danger">*</span>
                            </label>
                            <select name="status" id="edit-staff-status" class="form-control h-56-px bg-neutral-50 radius-12" required>
                                <option value="ACTIVE">Active</option>
                                <option value="INACTIVE">Inactive</option>
                            </select>
                            <small class="text-secondary-light d-flex align-items-center gap-1 mt-1">
                                <iconify-icon icon="mdi:information-outline" class="text-sm"></iconify-icon>
                                Inactive users cannot login to the system
                            </small>
                        </div>
                    </div>

                    <div class="d-flex align-items-center justify-content-end gap-3 mt-32 pt-24 border-top">
                        <button type="button" class="btn btn-outline-secondary text-sm px-24 py-12 radius-8 d-flex align-items-center gap-2" data-bs-dismiss="modal">
                            <iconify-icon icon="mdi:close" class="icon"></iconify-icon>
                            Cancel
                        </button>
                        <button type="submit" id="edit-staff-submit-btn" class="btn text-sm px-24 py-12 radius-8 d-flex align-items-center gap-2" style="background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); color: white; border: none;">
                            <iconify-icon icon="mdi:content-save" class="icon text-lg"></iconify-icon>
                            Save Changes
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Add Staff Modal -->
<div class="modal fade" id="addStaffModal" tabindex="-1" aria-labelledby="addStaffModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content radius-16 bg-base shadow-lg border-0">
            <!-- Modal Header with Gradient Background -->
            <div class="modal-header border-0 py-20 px-32" style="background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);">
                <div class="d-flex align-items-center gap-3">
                    <div class="w-48-px h-48-px rounded-circle bg-white bg-opacity-25 d-flex align-items-center justify-content-center">
                        <iconify-icon icon="flowbite:user-add-outline" class="text-white" style="font-size: 24px;"></iconify-icon>
                    </div>
                    <div>
                        <h5 class="modal-title text-white fw-bold mb-0" id="addStaffModalLabel">Add New Staff Member</h5>
                        <p class="text-white text-opacity-75 mb-0" style="font-size: 13px;">Create a new staff account for your company</p>
                    </div>
                </div>
                <button type="button" class="btn-close btn-close-white opacity-75" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            
            <!-- Modal Body -->
            <div class="modal-body p-32">
                <!-- Alert Messages -->
                <div id="modal-error" class="alert alert-danger radius-12 mb-24 d-none d-flex align-items-center gap-2">
                    <iconify-icon icon="mdi:alert-circle-outline" class="text-xl"></iconify-icon>
                    <span id="modal-error-text"></span>
                </div>
                <div id="modal-success" class="alert alert-success radius-12 mb-24 d-none d-flex align-items-center gap-2">
                    <iconify-icon icon="mdi:check-circle-outline" class="text-xl"></iconify-icon>
                    <span id="modal-success-text"></span>
                </div>
                
                <!-- Info Card -->
                <div class="card border-0 mb-24 radius-12" style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);">
                    <div class="card-body p-16 d-flex align-items-start gap-3">
                        <iconify-icon icon="mdi:information-outline" style="color: #1e40af;" class="text-xl mt-1"></iconify-icon>
                        <div>
                            <p class="text-sm mb-0 fw-medium" style="color: #1e40af;">After creating the staff account:</p>
                            <ul class="text-sm mb-0 ps-3 mt-1" style="color: #1e3a8a;">
                                <li>Staff can login with their email and password</li>
                                <li>They must select "Staff" as their role during login</li>
                                <li>They will have access to your company's data</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Form -->
                <form id="add-staff-form">
                    <div class="row g-3">
                        <!-- Full Name -->
                        <div class="col-12">
                            <label class="form-label fw-semibold text-primary-light text-sm mb-8 d-flex align-items-center gap-2">
                                <iconify-icon icon="mdi:account-outline" style="color: #2563eb;"></iconify-icon>
                                Full Name <span class="text-danger">*</span>
                            </label>
                            <div class="icon-field">
                                <span class="icon top-50 translate-middle-y">
                                    <iconify-icon icon="mdi:account" class="text-secondary-light"></iconify-icon>
                                </span>
                                <input type="text" name="name" class="form-control h-56-px bg-neutral-50 radius-12 ps-48" placeholder="e.g. John Smith" required>
                            </div>
                        </div>

                        <!-- Email Address -->
                        <div class="col-12">
                            <label class="form-label fw-semibold text-primary-light text-sm mb-8 d-flex align-items-center gap-2">
                                <iconify-icon icon="mdi:email-outline" style="color: #2563eb;"></iconify-icon>
                                Email Address <span class="text-danger">*</span>
                            </label>
                            <div class="icon-field">
                                <span class="icon top-50 translate-middle-y">
                                    <iconify-icon icon="mage:email" class="text-secondary-light"></iconify-icon>
                                </span>
                                <input type="email" name="email" class="form-control h-56-px bg-neutral-50 radius-12 ps-48" placeholder="e.g. staff@example.com" required>
                            </div>
                            <small class="text-secondary-light d-flex align-items-center gap-1 mt-1">
                                <iconify-icon icon="mdi:information-outline" class="text-sm"></iconify-icon>
                                This will be their login email
                            </small>
                        </div>

                        <!-- Password -->
                        <div class="col-12">
                            <label class="form-label fw-semibold text-primary-light text-sm mb-8 d-flex align-items-center gap-2">
                                <iconify-icon icon="mdi:lock-outline" style="color: #2563eb;"></iconify-icon>
                                Password <span class="text-danger">*</span>
                            </label>
                            <div class="icon-field position-relative">
                                <span class="icon top-50 translate-middle-y">
                                    <iconify-icon icon="solar:lock-password-outline" class="text-secondary-light"></iconify-icon>
                                </span>
                                <input type="password" name="password" id="staff-password" class="form-control h-56-px bg-neutral-50 radius-12 ps-48 pe-48" placeholder="Minimum 6 characters" required>
                                <span class="toggle-password ri-eye-line cursor-pointer position-absolute end-0 top-50 translate-middle-y me-16 text-secondary-light" data-toggle="#staff-password"></span>
                            </div>
                            <div class="mt-2 d-flex align-items-center gap-2">
                                <div class="progress flex-grow-1" style="height: 4px;">
                                    <div id="password-strength" class="progress-bar bg-danger" role="progressbar" style="width: 0%"></div>
                                </div>
                                <small id="password-strength-text" class="text-secondary-light"></small>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="d-flex align-items-center justify-content-end gap-3 mt-32 pt-24 border-top">
                        <button type="button" class="btn btn-outline-secondary text-sm px-24 py-12 radius-8 d-flex align-items-center gap-2" data-bs-dismiss="modal">
                            <iconify-icon icon="mdi:close" class="icon"></iconify-icon>
                            Cancel
                        </button>
                        <button type="submit" id="add-staff-submit-btn" class="btn text-sm px-24 py-12 radius-8 d-flex align-items-center gap-2" style="background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); color: white; border: none;">
                            <iconify-icon icon="mdi:account-plus" class="icon text-lg"></iconify-icon>
                            Add Staff Member
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Modal Styles -->
<style>
#addStaffModal .modal-content,
#editStaffModal .modal-content,
#deleteStaffModal .modal-content {
    overflow: hidden;
    animation: modalSlideIn 0.3s ease-out;
}

@keyframes modalSlideIn {
    from {
        opacity: 0;
        transform: translateY(-50px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

#addStaffModal .icon-field input:focus,
#editStaffModal .icon-field input:focus,
#editStaffModal select:focus {
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
}

#addStaffModal .toggle-password:hover {
    color: #2563eb !important;
}

#add-staff-submit-btn:hover,
#edit-staff-submit-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(37, 99, 235, 0.4);
    transition: all 0.3s ease;
}

#add-staff-submit-btn:disabled,
#edit-staff-submit-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none !important;
}

.btn-outline-secondary:hover {
    background-color: #f8f9fa;
    border-color: #dee2e6;
}

.btn-edit-staff,
.btn-delete-staff {
    border: none;
    transition: all 0.2s ease;
}

.btn-edit-staff:hover,
.btn-delete-staff:hover {
    transform: scale(1.1);
}

#confirm-delete-staff:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(220, 38, 38, 0.4);
    transition: all 0.3s ease;
}

#confirm-delete-staff:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none !important;
}
</style>

<% script = `<script src="/js/modules/staff-management.js"></script>` %>
